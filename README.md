# Прогнозирование просмотров видео на YouTube (США)

## Общая информация
**Проект:** Прогнозирование популярности видео на YouTube в США.  
**Цель:** На основе информации о видео предсказывать количество просмотров (views) с использованием машинного обучения.  

**Автор проекта:** Солодянкина Ариана, Хасенова Инкара  
**Источник данных:** (https://www.kaggle.com/datasnaek/youtube-new) на Kaggle  

---

## Датасет
Датасет содержит следующие ключевые признаки:  
- `video_id` — уникальный идентификатор видео  
- `title` — название видео  
- `channel_title` — название канала  
- `category_id` — категория видео  
- `publish_time` — время публикации видео  
- `tags` — теги видео  
- `views` — количество просмотров  
- `likes` — количество лайков  
- `dislikes` — количество дизлайков  
- `comment_count` — количество комментариев  
- `description` — описание видео  

JSON-файл с категориями содержит соответствие `category_id` → `category_name`.

---

## Этапы работы
1. **Исследовательский анализ данных (EDA)**
   - Анализ пропусков, выбросов и распределений признаков.  
   - Визуализации: боксплоты для просмотров, лайков, комментариев; гистограммы логарифма просмотров; графики популярности по категориям, часам и дням недели.  
   - Корреляционный анализ признаков для выявления взаимосвязей.

2. **Предобработка данных**
   - Заполнение пропусков (числовые признаки — медиана, категориальные — наиболее частое значение).  
   - Создание новых признаков:
     - `num_tags` — количество тегов видео  
     - `title_len` — длина заголовка  
     - `desc_len` — длина описания  
     - `publish_hour` и `publish_weekday` — час и день недели публикации  
   - Кодирование категориальных признаков (`category_name`) через OneHotEncoder.  
   - Масштабирование числовых признаков через StandardScaler.

3. **Обучение моделей**
   Использовались три модели:
   - **Linear Regression** — базовая линейная регрессия.  
   - **Random Forest Regressor** — ансамблевая модель на деревьях решений, n_estimators=200.  
   - **XGBoost Regressor** — градиентный бустинг, n_estimators=200, learning_rate=0.05.  

   Для всех моделей использовался пайплайн, который включал предобработку данных и обучение.

4. **Оценка качества моделей**
   Метрики:  
   - **MAE (Mean Absolute Error)** — средняя абсолютная ошибка по просмотрам  
   - **R² (коэффициент детерминации)** — качество предсказания логарифма просмотров  
   - **RMSE (Root Mean Squared Error)** — корень из средней квадратичной ошибки логарифма просмотров  

5. **Сравнение моделей и выводы**
   - Сравнение моделей по MAE и R² выявило лучшую модель для предсказания просмотров.  
   - Random Forest и XGBoost показали высокую точность, Linear Regression — базовую, для сравнения.  

---

## Результаты
- Сохранена лучшая модель (`best_youtube_model.pkl`).  
- Предсказания тестовой выборки сохранены в `test_predictions.csv`.  
- Визуализации распределений, корреляций и популярности видео по категориям/часам/дням недели помогают понять, какие признаки сильнее всего влияют на количество просмотров.

---

## Заключение
Проект показывает, что количество лайков, комментариев, категория видео и время публикации оказывают заметное влияние на популярность видео. Ансамблевые модели (Random Forest, XGBoost) более эффективно предсказывают просмотры, чем простая линейная регрессия.  

Проект демонстрирует полный цикл работы с данными: от EDA и предобработки до обучения моделей и оценки их качества.
